const handler = async (m, { conn }) => {
  const cooldown = 600_000; // 10 ุฏูุงุฆู
  const now = Date.now();
  const res = await m.db.query('SELECT exp, lastslut FROM usuarios WHERE id = $1', [m.sender]);
  const user = res.rows[0];
  const lastSlut = Number(user?.lastslut) || 0;
  const remaining = Math.max(0, lastSlut + cooldown - now);

  if (remaining > 0)
    return conn.reply(m.chat, `๐ฆ ูุฌุจ ุฃู ุชูุชุธุฑ ${msToTime(remaining)} ูุจู ุฃู ุชุฎุฑุฌ ูู ูุดูุงุฑ ุขุฎุฑ...`, m);

  const ganancias = Math.floor(Math.random() * 2500) + 1000;
  const ุงููุต = slut.getRandom();

  await m.db.query(`UPDATE usuarios SET exp = exp + $1, lastslut = $2 WHERE id = $3`, [ganancias, now, m.sender]);
  await conn.reply(m.chat, `*${ุงููุต}*\n\nุฑุจุญุช: *${formatNumber(ganancias)} XP*`, m);
};

handler.help = ['ูุดูุงุฑ'];
handler.tags = ['rpg', 'hot'];
handler.command = /^ูุดูุงุฑ$/i;
handler.register = true;

export default handler;

const slut = [
  "ุจุนุช ููุณู ููุงุจู ูุฌุจุฉ ูู ูุงูุฏููุงูุฏุฒ",
  "ุณููุช ุดุบู ุฎุงุต ูุน ุงูุฃุฏูู ููุงูุฆู",
  "ุณููุช ุฑูุตุฉ ูุบุฑูุฉ ููุฃุฏูู ูุฃุนุทุงู ุจูุดูุด",
  "ุญุณุงุจู ูู OnlyFans ุงููุฌุฑ 10 ุฏูุงุฆู ูุฌุฃุฉ",
  "ุงูุนููู ูุงู ููุฑู ูุฏูุนููู ุฏุจู",
  "ูุจุณุช ูุจุณ ุฎุงุฏูุฉ ูุถุจุทุช ูุนู",
  "ุงูุดูุจุฉ ูู ุงููุฑูุจ ุนุทุงู ุจูุดูุด",
  "ุนุฑุถุช ุญุถู ุจูููุณุ ูููููู ุบูุท",
  "ุงุดุชุบูุช ุนูู ุฒุงููุฉ ูุธููุฉ ูู ุณุงู ุฃูุฏุฑูุงุณ",
  "ุฏูุนูุง ูู ุนูุดุงู ุชุณูุช... ูุณูุช ุชูุงู",
  "ุฑุญุช ุงูููุทูุฉ ุงูุญูุฑุงุก ูุฑุฌุนุช ุจูููุณ",
  "ุชููุฑุช ุจุฒู ููุฒููู ููููุนุช ุงูุฌู",
  "ุณููุช ุชูุซูู ูุน ุงูุจูุช ููุงูุฃูู ุนูู ุงูุชุฒุงูู ุจุงูุฏูุฑ",
  "ุชููุฑุช ูุฅูููุฌู ููุงุญุฏ ุฏูุนูู ุนูุดุงู ูุณุชุฎุฏูู",
  "ุดูุฌุฑ ุฏุงุฏู ุฃุนุทุงู XP ููุงุจู ุฏูุน",
  "ุฏุฎูุช ุชุญุฏู (ุญูููุฉ ุฃู ุชุญุฏู) ูุงูููุชุช ุงูุฃููุฑ",
  "ุตูุฑุชู ุฌุฐุจุช ุชุจุฑุนุงุช ุจูุฑูุจ ุงูุนุฒุงุจ",
  "ุฃุฌูุฑุช ููุณู ูุฎูููุฉ ุฌูุงู ูุฎุตุตุฉ",
  "ุจุนุช ุจูุณุงุช ุฑูููุฉ ููุณุจุช ูุซูุฑ",
  "ุงููุงููู ุงููู ุจุฏุงุฎูู ุงุดุชุบูุช ูุฌุงุจุช ูููุณ",
  "ุตูุฑุฉ ุจุฑููุงููู ุฃุนุฌุจุช ูุดุฑู ููุงูุฆู",
  "ูุจูุช ุชุทูุน ูุน ุดุฎุต ูุง ูุชููู ุฅูุง ุงุณุชูุฑุงุช",
  "ูุจุณุช ูุจุณ ุจูุช NSFW ููุง ุญุฏ ูุงุญุธ ุงููุฑู",
  "ุณููุช ุฏููุชู ุชูู ุชูู ุญุงุฑ ูุฑุจุญุช",
  "VTuber ูุธูู ููุณุงุนุฏ ุดุฎุตู ุฌุฑูุก",
  "ุงุณุชููุฑุงุชู ุงูุชุดุฑุช ูุทูุจุช ูุณุจุฉ",
  "ุฃุฑุณููุง ูู ูููุณ ุจุณ ุนูุดุงู ุชููู (ุฏุงุฏู) ุจุตูุชู",
  "ุชููุฑุช ูุซู ุณูุฑู ูุทูุจูุง ููู ุฃูุงูุฑ ุบุฑูุจุฉ",
  "ูุฏููุช ุฏุฑูุณ ุฎุตูุตูุฉ ูุดุจููุฉ ูู ุงููุฑูุจ",
  "ููุช ูุฌู ุณูุฑุฉ ูู ูุงุฒููู RPG",
  "ุจุนุช ุตูุฑ ุฑุฌููู ูุฑุณููุฉ ุจูุต ASCII",
  "ุฃุฌูุฑุช ููุณู ูุดุฎุตูุฉ NPC ูุซูุฑุฉ",
  "ุดุงุฑูุช ูู ูุนุงููุฉ ุญุงุฑุฉ ูู ุณูุฑูุฑ ูุงูููุฑุงูุช",
  "ุณููุช ุฃุดูุงุก ูุดุจููุฉ ููุฃุฏูู ููุงุจู XP",
  "ุณุฌูุช ุฃูุงูุฑ ุจุตูุชู ูุจุนุชูุง ุจูููุณ",
  "ุณููุช ุญุณุงุจ OnlyBots ูุตุฑุช ุชุฑูุฏ",
  "ุชุธุงูุฑุช ุฅูู ูุดุฑู ูุบุฑู ููุฑุถุช ุบุฑุงูุงุช",
  "ุงุณูู ุทูุน ูู ูุงู ููู ููุงูุฆู ุงููุงุชุจ",
  "ูุธูุช ุญููุฉ ูุนูุงุช ุงูุชุฑุงุถูุฉ ุจุชุฐุงูุฑ ูุฏููุนุฉ",
  "ุฑูุตุช ูุจูุช ุงูุงูุชุตุงุฏ ูุณุญุจ ูู ุฑุตูุฏู"
];

function formatNumber(num) {
  return num.toLocaleString("en").replace(/,/g, ".");
}

function msToTime(duration) {
  const totalSeconds = Math.floor(duration / 1000);
  const minutes = Math.floor(totalSeconds / 60);
  const seconds = totalSeconds % 60;
  return `${minutes} ุฏูููุฉ ู ${seconds} ุซุงููุฉ`;
}
